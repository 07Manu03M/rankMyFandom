<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/crear.css">
    <title>Crear</title>
</head>

<body>
    <header class="menu_header">
        <div class="logotipado">
            <img src="../storage/img/logoprincipal.svg" alt="">
            <h1>Rank My Fandom</h1>
        </div>
        <div class="opciones_menu">
            <a href="../views/principal.html">Home</a>
            <a href="../views/peliculas.html">Peliculas</a>
            <a href="../views/series.html">Series</a>
            <a href="../views/crear.html">Crear</a>
        </div>
        <div class="infouser">
            <img src="../storage/img/usuarionormal.png" alt="">
            <p id="nombreUsuario"></p>
        </div>
    </header>

    <main class="caja_main">
        <div class="caja_principal">
            <div class="input_titulo">
                <h5>Titulo de la Funcion</h5>
                <input type="text" id="titulo" placeholder="Titulo de la Funcion">
            </div>
            <div class="input_descripcion">
                <h5>Descripcion de la Funcion</h5>
                <input type="text" id="descripcion" placeholder="Descripcion de la Funcion">
            </div>
            <div class="input_fecha">
                <h5>Fecha de la Funcion</h5>
                <input type="date" id="fecha" placeholder="Fecha de la Funcion">
            </div>
            <div class="input_categoria">
                <h5 for="categoria">Selecciona una opcion:</h5>
                <select id="categoria" name="categoria">
                    <option value="Seleccionar">Seleccione una opcion</option>
                    <option value="Pelicula">Pelicula</option>
                    <option value="Serie">Serie</option>
                </select>
            </div>
            <div class="input_subcategoria">
                <h5 for="categorias">Seleccione una categoria</h5>
                <select id="categorias" name="categorias">
                    <option value="Seleccionar">Seleccione una opcion</option>
                    <option value="Accion">Accion</option>
                    <option value="Comedia">Comedia</option>
                    <option value="Drama">Drama</option>
                </select>
            </div>
            <div class="input_imagen">
                <h5>Imagen de la Funcion</h5>
                <input type="text" id="imagen" placeholder="URL de la Imagen">
            </div>
            <div class="input_boton">
                <button id="crearBtn">Crear</button>
            </div>
        </div>
    </main>

    <script>
        crearBtn.addEventListener('click', async (e) => {
  e.preventDefault();

  const titulo = document.getElementById('titulo').value;
  const descripcion = document.getElementById('descripcion').value;
  const anio = document.getElementById('fecha').value; // usa el name igual al backend
  const tipo = document.getElementById('categoria').value;
  const categoria = document.getElementById('categorias').value;
  const img = document.getElementById('imagen').value;

  if (!titulo || !descripcion || !anio || tipo === "Seleccionar" || categoria === "Seleccionar" || !img) {
    alert('Por favor completa todos los campos.');
    return;
  }

  try {
    const res = await fetch('http://localhost:3000/api/v1/movies', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ titulo, descripcion, anio, tipo, categoria, img })
    });

    const newMovie = await res.json();
    console.log('Película creada:', newMovie);

    alert('Película creada exitosamente!');
  } catch (err) {
    console.error('Error creando la película:', err);
    alert('Error al crear la película');
  }
});
    </script>
</body>

</html>