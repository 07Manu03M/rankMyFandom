<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/crearcategory.css">
    <title>Crear Categoría</title>
</head>

<body>
    <header class="menu_header">
        <div class="logotipado">
            <img src="../storage/img/logoprincipal.svg" alt="">
            <h1>Rank My Fandom</h1>
        </div>
        <div class="opciones_menu">
            <a href="../views/admin.html">Aprobadas</a>
            <a href="../views/pendientes.html">Pendientes</a>
            <a href="../views/crearcategory.html">Crear</a>
        </div>
        <div class="opcion_notificacion">
            <img src="../storage/img/lupita.svg" alt="">
            <img src="../storage/img/campanita.svg" alt="">
        </div>
    </header>

    <main class="caja_main">
        <div class="caja_principal">
            <div class="input_titulo">
                <h5>Titulo de la categoría</h5>
                <input type="text" id="titulo" placeholder="Titulo de la categoría">
            </div>
            <div class="input_descripcion">
                <h5>Descripción de la categoría</h5>
                <input type="text" id="descripcion" placeholder="Descripción de la categoría">
            </div>
            <div class="input_fecha">
                <h5>Fecha de creación</h5>
                <input type="date" id="fecha" placeholder="Fecha de creación">
            </div>
            <div class="input_boton">
                <button id="crearCategoriaBtn">Crear</button>
            </div>
        </div>
    </main>

    <script>
        document.getElementById('crearCategoriaBtn').addEventListener('click', async (e) => {
            e.preventDefault();

            const titulo = document.getElementById('titulo').value;
            const descripcion = document.getElementById('descripcion').value;
            const fecha = document.getElementById('fecha').value;

            if (!titulo || !descripcion || !fecha) {
                alert('Por favor completa todos los campos.');
                return;
            }

            try {
                const res = await fetch('http://localhost:3000/api/v1/categories', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ titulo, descripcion, fecha })
                });

                if (!res.ok) {
                    throw new Error('Error en la respuesta del servidor');
                }

                const newCategory = await res.json();
                console.log('Categoría creada:', newCategory);

                alert('Categoría creada exitosamente!');
                // limpiar inputs
                document.getElementById('titulo').value = '';
                document.getElementById('descripcion').value = '';
                document.getElementById('fecha').value = '';
            } catch (err) {
                console.error('Error creando la categoría:', err);
                alert('Error al crear la categoría');
            }
        });
    </script>
</body>

</html>
